## 1. 모델정보

```python
model = Sequential()
model.add(Embedding(vocab_size + 1, embedding_dim, input_length=comment_len))
model.add(Bidirectional(LSTM(64, return_sequences=True)))
model.add(Bidirectional(LSTM(64, return_sequences=False)))
model.add(Dense(1, activation='sigmoid'))


model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
```

```python
es = EarlyStopping(monitor='val_loss', mode='min', verbose=1, patience=4)
mc = ModelCheckpoint('erase_label_1.h5', monitor= 'val_loss', mode='min', save_best_only=True)
```

```python
history = model.fit(train_over, y_train_over, 
                    callbacks        = [es, mc],
                    epochs           = 10, 
                    batch_size       = 128, 
                    validation_split = 0.3)
```





## 2. 학습결과

```powershell
Epoch 1/10
505/505 [==============================] - 1291s 3s/step - loss: 0.3966 - accuracy: 0.8304 - val_loss: 0.6266 - val_accuracy: 0.6794
Epoch 2/10
505/505 [==============================] - 1311s 3s/step - loss: 0.3057 - accuracy: 0.8801 - val_loss: 0.4527 - val_accuracy: 0.7956
Epoch 3/10
505/505 [==============================] - 1328s 3s/step - loss: 0.2723 - accuracy: 0.8945 - val_loss: 0.4081 - val_accuracy: 0.7954
Epoch 4/10
505/505 [==============================] - 1292s 3s/step - loss: 0.2507 - accuracy: 0.9045 - val_loss: 0.3150 - val_accuracy: 0.8531
Epoch 5/10
505/505 [==============================] - 1314s 3s/step - loss: 0.2238 - accuracy: 0.9183 - val_loss: 0.3552 - val_accuracy: 0.8479
Epoch 6/10
505/505 [==============================] - 1352s 3s/step - loss: 0.1975 - accuracy: 0.9270 - val_loss: 0.2459 - val_accuracy: 0.8973
Epoch 7/10
505/505 [==============================] - 1295s 3s/step - loss: 0.1789 - accuracy: 0.9341 - val_loss: 0.2649 - val_accuracy: 0.8786
Epoch 8/10
505/505 [==============================] - 1306s 3s/step - loss: 0.1713 - accuracy: 0.9364 - val_loss: 0.2761 - val_accuracy: 0.8879
Epoch 9/10
505/505 [==============================] - 1313s 3s/step - loss: 0.1501 - accuracy: 0.9451 - val_loss: 0.3039 - val_accuracy: 0.8811
Epoch 10/10
505/505 [==============================] - 1296s 3s/step - loss: 0.1409 - accuracy: 0.9482 - val_loss: 0.2094 - val_accuracy: 0.9219
```



##### confusion matrix

```powershell
array([[11057,   497],
       [  511,   722]])
```

```powershell
recall :  0.5855636658556367
precision :  0.5922887612797375
f1_score :  0.5889070146818923
roc_auc_score :  0.893694679220321
```

